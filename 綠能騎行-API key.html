<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ˜Ÿç©ºä¸‹çš„ç¶ èƒ½é¨è¡Œ - äº’å‹•ç°¡å ±</title>
    
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- å¼•å…¥ React å’Œ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- å¼•å…¥ Babel ç”¨æ–¼è§£æ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- å¼•å…¥ FontAwesome ä½œç‚ºåœ–ç¤ºåº« (æ›¿ä»£ Lucide) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* è‡ªå®šç¾©å‹•ç•« */
        @keyframes float {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
        @keyframes float-delayed {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-15px); }
        }
        @keyframes pulse-slow {
          0%, 100% { opacity: 0.8; transform: scale(1); }
          50% { opacity: 1; transform: scale(1.05); }
        }
        @keyframes blob {
          0% { transform: translate(0px, 0px) scale(1); }
          33% { transform: translate(30px, -50px) scale(1.1); }
          66% { transform: translate(-20px, 20px) scale(0.9); }
          100% { transform: translate(0px, 0px) scale(1); }
        }
        @keyframes spin-slow {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes bounce-slow {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-15px); }
        }
        @keyframes bikeRide {
          0% { transform: translateX(-10vw) scaleX(1); }
          45% { transform: translateX(90vw) scaleX(1); }
          50% { transform: translateX(90vw) scaleX(-1); }
          95% { transform: translateX(-10vw) scaleX(-1); }
          100% { transform: translateX(-10vw) scaleX(1); }
        }
        .animate-float { animation: float 6s ease-in-out infinite; }
        .animate-float-delayed { animation: float-delayed 7s ease-in-out infinite; }
        .animate-pulse-slow { animation: pulse-slow 4s ease-in-out infinite; }
        .animate-blob { animation: blob 7s infinite; }
        .animate-spin-slow { animation: spin-slow 20s linear infinite; }
        .animation-delay-2000 { animation-delay: 2s; }
        .animate-slideDown { animation: slideDown 0.8s ease-out; }
        .animate-fadeIn { animation: fadeIn 0.8s ease-out; }
        .animate-bounce-slow { animation: bounce-slow 3s infinite; }
        .animate-bike-ride { animation: bikeRide 15s linear infinite; }
        
        @keyframes slideDown {
          from { transform: translateY(-20px); opacity: 0; }
          to { transform: translateY(0); opacity: 1; }
        }
        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        /* éš±è—æ²è»¸ä½†ä¿ç•™åŠŸèƒ½ */
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icon Components (Mapping Lucide props to FontAwesome) ---
        const FAIcon = ({ icon, className = "", size }) => {
            return <i className={`${icon} ${className} flex items-center justify-center`} style={{ fontSize: size ? size + 'px' : undefined }}></i>;
        };

        const ChevronRight = (p) => <FAIcon icon="fa-solid fa-chevron-right" {...p} />;
        const ChevronLeft = (p) => <FAIcon icon="fa-solid fa-chevron-left" {...p} />;
        const Wind = (p) => <FAIcon icon="fa-solid fa-wind" {...p} />;
        const Zap = (p) => <FAIcon icon="fa-solid fa-bolt" {...p} />;
        const Heart = (p) => <FAIcon icon="fa-solid fa-heart" {...p} />;
        const Clock = (p) => <FAIcon icon="fa-solid fa-clock" {...p} />;
        const Leaf = (p) => <FAIcon icon="fa-solid fa-leaf" {...p} />;
        const Gamepad2 = (p) => <FAIcon icon="fa-solid fa-gamepad" {...p} />;
        const Sparkles = (p) => <FAIcon icon="fa-solid fa-wand-magic-sparkles" {...p} />;
        const MessageCircle = (p) => <FAIcon icon="fa-regular fa-comment-dots" {...p} />;
        const X = (p) => <FAIcon icon="fa-solid fa-xmark" {...p} />;
        const User = (p) => <FAIcon icon="fa-solid fa-user" {...p} />;
        const BookOpen = (p) => <FAIcon icon="fa-solid fa-book-open" {...p} />;
        const Star = (p) => <FAIcon icon="fa-solid fa-star" {...p} />;
        const Play = (p) => <FAIcon icon="fa-solid fa-play" {...p} />;
        const Youtube = (p) => <FAIcon icon="fa-brands fa-youtube" {...p} />;
        const ExternalLink = (p) => <FAIcon icon="fa-solid fa-up-right-from-square" {...p} />;
        const Bike = (p) => <FAIcon icon="fa-solid fa-bicycle" {...p} />;
        const Sun = (p) => <FAIcon icon="fa-solid fa-sun" {...p} />;
        const Moon = (p) => <FAIcon icon="fa-solid fa-moon" {...p} />;

        // --- Gemini API Helper (Multi-Key Fallback) ---
        const API_KEYS = [
            "AIzaSyDIruwrl1acAVBcdCYHsCwu8KdztSXQTGU" 
        ];

        const callGemini = async (prompt) => {
            for (let i = 0; i < API_KEYS.length; i++) {
                const apiKey = API_KEYS[i];
                try {
                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`,
                        {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({
                                contents: [{ parts: [{ text: prompt }] }],
                            }),
                        }
                    );

                    if (!response.ok) {
                        console.warn(`API Key ${i + 1} failed. Status: ${response.status}. Trying next...`);
                        continue;
                    }

                    const data = await response.json();
                    
                    if (data.candidates && data.candidates.length > 0 && data.candidates[0].content) {
                        return data.candidates[0].content.parts[0].text;
                    } else {
                        console.warn(`API Key ${i + 1} returned unexpected structure. Trying next...`);
                        continue;
                    }

                } catch (error) {
                    console.warn(`API Key ${i + 1} network error:`, error);
                    continue;
                }
            }
            
            // å¦‚æœæ‰€æœ‰ Key éƒ½å¤±æ•—ï¼Œå›å‚³ null è€Œä¸æ˜¯æ‹‹å‡ºéŒ¯èª¤ï¼Œé¿å… Console å‡ºç¾ç´…å­—
            console.warn("All API keys failed or quota exceeded. Switching to offline mock mode.");
            return null;
        };

        // --- è³‡æ–™çµæ§‹ ---
        const slidesData = [
            {
                id: 0,
                title: "SDGsé›¶ç¢³å¥èº«æˆ¿",
                subtitle: "ä»¥NotebookLMåˆ†æ,Geminiè£½ä½œ <br/>-æŸéŒ¦ç‰20251216",
                content: [],
                visual: "cover",
                script: "å¤§å®¶å¥½ï¼Œæ­¡è¿ä¾†åˆ°ã€ŒSDGsé›¶ç¢³å¥èº«æˆ¿ã€ã€‚é€™æ˜¯ä¸€å€‹çµåˆå¥åº·ã€æ°¸çºŒèˆ‡ç§‘æŠ€çš„å‰µæ–°å°ˆæ¡ˆ..."
            },
            {
                id: 1,
                title: "æ´»å‹•å½±éŸ³ç´€éŒ„",
                subtitle: "ç¾å ´å¯¦éŒ„èˆ‡ AI ç”Ÿæˆè§£èªª",
                content: [
                "æ´»å‹•ä¸»é«”ï¼šå°‡å¥åº·ä¿ƒé€² (SDG 3) èˆ‡æ°¸çºŒèƒ½æº (SDG 7) å®Œç¾çµåˆã€‚",
                "æ ¸å¿ƒé¡˜æ™¯ï¼šæ¯ä¸€åº¦é›»éƒ½ä¾†ä¹‹ä¸æ˜“ï¼Œç”¨æ±—æ°´é»äº®åœ°çƒã€‚",
                "SDGs æ•ˆç›Šï¼šå»¶ä¼¸è‡³å„ªè³ªæ•™è‚² (SDG 4) èˆ‡è² è²¬ä»»æ¶ˆè²» (SDG 12)ã€‚",
                "USR å…¸ç¯„ï¼šé€™ä¸åªæ˜¯é‹å‹•ï¼Œæ›´æ˜¯å¤§å­¸ç¤¾æœƒè²¬ä»»çš„å¯¦è¸ã€‚"
                ],
                visual: "video_intro", 
                script: "é¦–å…ˆå¸¶å¤§å®¶çœ‹åˆ°æ´»å‹•çš„å½±éŸ³ç´€éŒ„ã€‚æˆ‘å€‘é€éå½±åƒè¨˜éŒ„äº†åŒå­¸å€‘æ®ç‘æ±—æ°´çš„æ™‚åˆ»..."
            },
            {
                id: 2,
                title: "æ ¸å¿ƒåƒ¹å€¼ Iï¼šé›¶ç¢³å¥èº«æ¨‚åœ’",
                subtitle: "ä¸åƒ…æ˜¯è…³è¸è»Šï¼Œé‚„æœ‰ Switch çš„æ­¡æ¨‚",
                content: [
                "æ‰“ç ´é™åˆ¶ï¼šåœ–æ›¸é¤¨å¤§å»³çš„ã€Œé›¶ç¢³å¥èº«æˆ¿ã€ï¼Œç„¡æ‡¼é¢¨é›¨ã€‚",
                "è¤‡åˆä¼‘é–’ï¼šé‚Šé¨è»Šé‚Šè¿½åŠ‡ï¼Œäº«å—ã€Œç™¼å¤šå°‘é›»ï¼Œå¹å¤šå°‘é¢¨ã€çš„æ¶¼çˆ½ã€‚",
                "å¤šå…ƒè¨­æ–½ï¼šé™¤äº†ç¶ èƒ½è…³è¸è»Šï¼Œæ–°å¢ Switch (Sports/å¥èº«ç’°)ï¼Œè®“é‹å‹•åƒéŠæˆ²ä¸€æ¨£æœ‰è¶£ï¼",
                "å¥åº·å›é¥‹ï¼š45åˆ†é˜æ¶ˆè€— 600 å¤§å¡ï¼Œé‡‹æ”¾å£“åŠ›ï¼Œç™‚ç™’èº«å¿ƒã€‚"
                ],
                visual: "playground",
                script: "é¦–å…ˆï¼Œæˆ‘å€‘æ‰“é€ äº†ä¸€å€‹ã€Œé›¶ç¢³å¥èº«æˆ¿ã€ã€‚é€™äº›ç¶ èƒ½è…³è¸è»Šè¨­ç½®åœ¨åœ–æ›¸é¤¨å¤§å»³...æˆ‘å€‘æ›´å¼•å…¥äº† Switch å¥èº«ç’°ï¼Œè®“ä¸æƒ³å–®ç´”é¨è»Šçš„åŒå­¸ä¹Ÿèƒ½åœ¨éŠæˆ²ä¸­æ®ç‘æ±—æ°´ã€‚"
            },
            {
                id: 3,
                title: "æ ¸å¿ƒåƒ¹å€¼ IIï¼šèƒ½æºè¦ºå¯Ÿ",
                subtitle: "æ±—æ°´æ›ä¾†çš„æ¯ä¸€åº¦é›»",
                content: [
                "éœ‡æ’¼æ•™è‚²ï¼š1 åº¦é›» = 28 å°æ™‚ (1680åˆ†é˜) çš„å¥®åŠ›é¨ä¹˜ã€‚",
                "çœŸå¯¦é«”é©—ï¼šæœ‰åŒå­¸é¨äº† 14 å°æ™‚ï¼Œæ‰ç´¯ç© 0.35 åº¦é›»ã€‚",
                "è¡Œç‚ºæ”¹è®Šï¼šå›å®¶å¾Œã€Œæ¨ä¸å¾—é–‹å†·æ°£ã€ï¼Œéš¨æ‰‹é—œç‡ˆè®Šæˆç¿’æ…£ã€‚",
                "æ•™è‚²æ„ç¾©ï¼šå°‡æŠ½è±¡çš„æ°¸çºŒå£è™Ÿï¼ŒåŒ–ç‚ºå…·é«”çš„è‚Œè‚‰è¨˜æ†¶ã€‚"
                ],
                visual: "bulb",
                script: "ç¬¬äºŒå€‹æ ¸å¿ƒåƒ¹å€¼ï¼Œåœ¨æ–¼ã€Œèƒ½æºè¦ºå¯Ÿã€ã€‚æˆ‘å€‘å¸¸èªªè¦ç¯€èƒ½ï¼Œä½†é›»æ˜¯æŠ½è±¡çš„ã€‚é€éé€™å€‹æ´»å‹•ï¼Œæˆ‘å€‘å°‡é›»é‡ã€Œå…·è±¡åŒ–ã€..."
            },
            {
                id: 4,
                title: "é‡åŒ–æˆæœèˆ‡ç™¼é›»ç‹",
                subtitle: "é‚£äº›é»˜é»˜è€•è€˜çš„ç™¼é›»è‹±é›„",
                content: [
                "ç¸½é«”è²¢ç»ï¼šç´¯ç©ç™¼é›» > 102 åº¦ï¼Œåƒèˆ‡äººæ•¸ 1,331 äººã€‚",
                "å­¸ç”Ÿç™¼é›»ç‹ï¼šç‹åŒå­¸ (7.18 KWH) - æ¯…åŠ›çš„å±•ç¾ã€‚",
                "æ•™è·ç™¼é›»ç‹ï¼šæ¥ŠåŒä» (2.97 KWH) - ç©©å®šçš„æ¦œæ¨£ã€‚",
                "æ´å¯Ÿï¼šé«˜è²¢ç»è€…éƒ½é¤Šæˆäº†ã€Œå–®æ¬¡é¨ä¹˜ > 1å°æ™‚ã€çš„è€åŠ›ç¿’æ…£ã€‚"
                ],
                visual: "chart",
                script: "è®“æˆ‘å€‘ä¾†çœ‹çœ‹å…·é«”çš„é‡åŒ–æˆæœã€‚æˆªè‡³ç›®å‰ï¼Œå…¨æ ¡å…±æœ‰ 1,331 äººæ¬¡åƒèˆ‡ï¼Œåˆ·å¡ç´€éŒ„è¶…éå…­åƒç­†..."
            },
            {
                id: 5,
                title: "é¨ä¹˜è¡Œç‚ºæ¨¡å¼æ´å¯Ÿ",
                subtitle: "åƒé¦¬æ‹‰æ¾ä¸€æ¨£çš„äººç”Ÿ",
                content: [
                "è€åŠ›ç­–ç•¥ï¼šä¸æ±‚ç™¾ç±³è¡åˆºï¼Œä½†æ±‚é•·ä¹…å …æŒã€‚",
                "è‡ªæˆ‘æ¿€å‹µï¼šçœ‹è‘—å„€è¡¨æ¿æ•¸å­—è·³å‹•ï¼Œæ˜¯çªç ´è‡ªæˆ‘çš„é­”åŠ›ã€‚",
                "å¤šå·¥è™•ç†ï¼šä¸€é‚Šé¨è»Šï¼Œä¸€é‚Šç·´è‹±æ–‡è½åŠ›ã€çœ‹ä¸Šèª²éŒ„å½±ã€‚",
                "ç”Ÿæ´»èå…¥ï¼šé‹å‹•ä¸å†æ˜¯æ™‚é–“çš„æ¶ˆè€—ï¼Œè€Œæ˜¯æ™‚é–“çš„åŠ å€¼ã€‚"
                ],
                visual: "runner",
                script: "æ·±å…¥åˆ†æä½¿ç”¨è€…çš„è¡Œç‚ºï¼Œæˆ‘å€‘ç™¼ç¾é«˜ç”¢å‡ºè€…æ¡å–çš„ç­–ç•¥æ˜¯ã€Œé¦¬æ‹‰æ¾ã€è€Œéã€Œç™¾ç±³è¡åˆºã€..."
            },
            {
                id: 6,
                title: "ä½¿ç”¨è€…è¡Œç‚ºåˆ†æï¼šæ™‚æ®µ",
                subtitle: "æ—¥èˆ‡å¤œçš„æ¥åŠ›è³½",
                content: [
                "å­¸ç”Ÿæ—ç¾¤ï¼šä¸‹åˆèª²å¾Œè‡³æ·±å¤œï¼Œæ’è§£è®€æ›¸è‹¦æ‚¶çš„å‡ºå£ã€‚",
                "æ•™è·å“¡å·¥ï¼šæœä¹æ™šäº”å‰å¾Œï¼Œè¦å¾‹çš„æ‰“å¡å¼é‹å‹•ã€‚",
                "å…±åŒäº¤é›†ï¼šä¸­åˆæ™‚åˆ»ï¼Œå¸«ç”Ÿä¸€åŒåœ¨åœ–æ›¸é¤¨æ®ç‘æ±—æ°´ã€‚",
                "ç©ºé–“æ„ç¾©ï¼šåœ–æ›¸é¤¨æˆç‚ºäº†å…¨æ ¡æœ€å¥åº·çš„äº¤æœƒé»ã€‚"
                ],
                visual: "clock",
                script: "æˆ‘å€‘é€²ä¸€æ­¥åˆ†æäº†å¤§å®¶éƒ½åœ¨ã€Œä»€éº¼æ™‚å€™ã€é¨è»Šã€‚æ•™è·å“¡çš„æ¨¡å¼éå¸¸è¦å¾‹...æœ‰è¶£çš„æ˜¯ï¼Œä¸­åˆæ™‚æ®µæ˜¯é›™æ–¹çš„å…±åŒäº¤é›†..."
            },
            {
                id: 7,
                title: "æ•¸æ“šé©…å‹•çš„å„ªåŒ–",
                subtitle: "æˆ‘å€‘ä¸€ç›´åœ¨é€²æ­¥",
                content: [
                "é–€æª»èª¿æ•´ï¼šé‡å°å›é¥‹è¨­å®šåˆ†ç´šç›®æ¨™ï¼Œè®“æ›´å¤šäººèƒ½ç²çã€‚",
                "æ™‚ç¨‹å„ªåŒ–ï¼šæ–°ç”Ÿè³½å»¶å¾Œé–‹è·‘ï¼Œçµ¦äºˆé©æ‡‰æœŸã€‚",
                "ç¨‹åºç°¡åŒ–ï¼šåˆ·å¡å³åƒåŠ ï¼Œä¸ç”¨å ±åï¼Œé™ä½é–€æª»ã€‚",
                "é€æ˜æ¿€å‹µï¼šå…¬é–‹æ’åèˆ‡ã€Œ100å…ƒç¦®åˆ¸ã€çå‹µï¼Œæ¿€ç™¼ç†±æƒ…ã€‚"
                ],
                visual: "growth",
                script: "é€™é …æ´»å‹•ä¸¦éä¸€æˆä¸è®Šï¼Œæˆ‘å€‘æŒçºŒä¾ç…§æ•¸æ“šèˆ‡å›é¥‹é€²è¡Œå„ªåŒ–..."
            },
            {
                id: 8,
                title: "ç¸½çµèˆ‡æ°¸çºŒå±•æœ›",
                subtitle: "å¥åº·æ°¸çºŒï¼Œå…±æ¦®æœªä¾†",
                content: [
                "åƒ¹å€¼æ ¸å¿ƒï¼šé«˜æ•ˆç›Šã€ä½æˆæœ¬çš„æ°¸çºŒç™¼å±•å·¥å…·ã€‚",
                "å¤šé‡æ•ˆç›Šï¼šå¥åº· x æ•™è‚² x ç’°ä¿ x å¨›æ¨‚ (Switch)ã€‚",
                "æœªä¾†å±•æœ›ï¼šæŒçºŒé€éæ•¸æ“šåˆ†æï¼Œå„ªåŒ–æ´»å‹•é«”é©—ã€‚",
                "è¡Œå‹•å‘¼ç±²ï¼šè®“æˆ‘å€‘ç”¨æ±—æ°´é©…å‹•æ°¸çºŒï¼Œä¸€èµ·å‹•èµ·ä¾†ï¼"
                ],
                visual: "tree",
                script: "æœ€å¾Œï¼Œç¸½çµä»Šå¤©çš„å ±å‘Šã€‚ç¶ èƒ½è…³è¸è»Šæ´»å‹•è­‰æ˜äº†ï¼Œåœ–æ›¸é¤¨ä¸åªæ˜¯çŸ¥è­˜çš„æ®¿å ‚ï¼Œä¹Ÿèƒ½æ˜¯å¥åº·çš„å ´åŸŸ..."
            }
        ];

        // --- AI åŠ©æ‰‹å…ƒä»¶ ---
        const AIAssistant = ({ onClose, isDayMode }) => {
            const [step, setStep] = useState('input');
            const [mood, setMood] = useState('');
            const [time, setTime] = useState('');
            const [result, setResult] = useState(null);

            const moodMap = {
                'stress': 'å£“åŠ›å¾ˆå¤§ï¼Œæƒ³ç™¼æ´©',
                'energetic': 'å……æ»¿æ´»åŠ›ï¼Œæƒ³æŒ‘æˆ°',
                'bored': 'æœ‰é»ç„¡èŠï¼Œæƒ³æ‰¾æ¨‚å­'
            };

            const timeMap = {
                'short': 'å°‘æ–¼ 30 åˆ†é˜',
                'long': 'å¤šæ–¼ 30 åˆ†é˜'
            };

            const generatePlan = async () => {
                setStep('processing');
                
                const prompt = `
                ä½ æ˜¯ä¸€ä½æº«æš–ã€å……æ»¿æƒ³åƒåŠ›çš„å¥èº«æ•™ç·´ï¼Œèªªè©±é¢¨æ ¼åƒå¹¾ç±³çš„ç¹ªæœ¬ï¼Œå¸¶æœ‰è©©æ„å’Œç•«é¢æ„Ÿã€‚
                ä½¿ç”¨è€…ç›®å‰çš„å¿ƒæƒ…æ˜¯ï¼šã€Œ${moodMap[mood]}ã€ï¼Œæ“æœ‰çš„æ™‚é–“æ˜¯ï¼šã€Œ${timeMap[time]}ã€ã€‚
                
                è«‹æ ¹æ“šä»¥ä¸‹é‚è¼¯ç‚ºä»–æ¨è–¦ä¸€å€‹æ´»å‹•æ–¹æ¡ˆï¼š
                1. è‹¥ä½¿ç”¨è€…çš„æ™‚é–“æ˜¯ã€Œå¤šæ–¼ 30 åˆ†é˜ã€ï¼šè«‹å¼·çƒˆæ¨è–¦ã€ŒSwitch + è…³è¸è»Šã€çš„äºŒé …çµ„åˆï¼Œèªªæ˜é€™æ¨£å¯ä»¥åŒæ™‚äº«å—æ¨‚è¶£èˆ‡è€åŠ›è¨“ç·´ã€‚
                2. è‹¥æ™‚é–“è¼ƒçŸ­ï¼šå¯å¾ã€Œç¶ èƒ½è…³è¸è»Šã€æˆ–ã€ŒSwitch å¥èº«ç’°ã€ä¸­æ“‡ä¸€æ¨è–¦ã€‚
                
                è«‹ç›´æ¥å›å‚³ä¸€å€‹ JSON æ ¼å¼å­—ä¸² (ä¸è¦æœ‰ markdown æ¨™è¨˜)ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š
                {
                    "activity": "æ¨è–¦çš„æ´»å‹•åç¨± (ä¾‹å¦‚ï¼šSwitch + è…³è¸è»Š é›™é‡å¥)",
                    "reason": "ä¸€æ®µç´„ 40-60 å­—çš„æ¨è–¦ç†ç”±ï¼Œèªæ°£è¦æº«æŸ”ç™‚ç™’ï¼Œåƒæ˜¯åœ¨è·Ÿæœ‹å‹èªªè©±ã€‚",
                    "iconType": "å›å‚³å­—ä¸²: 'combo' (è‹¥æ˜¯é›™é …çµ„åˆ), 'gamepad' (Switch), 'zap' (è…³è¸è»Š)"
                }
                `;

                try {
                    const responseText = await callGemini(prompt);
                    
                    // å¦‚æœ API å›å‚³ null (ä»£è¡¨å¤±æ•—)ï¼Œæ‰‹å‹•è§¸ç™¼ Error é€²å…¥ catch å€å¡Šï¼Œæˆ–æ˜¯ç›´æ¥è™•ç†
                    if (!responseText) throw new Error("API Limit Reached");

                    let jsonString = responseText.replace(/```json/g, '').replace(/```/g, '').trim();
                    const jsonMatch = jsonString.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        jsonString = jsonMatch[0];
                    }

                    const plan = JSON.parse(jsonString);
                    
                    // æ ¹æ“šå›å‚³çš„ iconType è¨­å®šå°æ‡‰çš„åœ–ç¤º
                    if (plan.iconType === 'combo') {
                        plan.icon = (
                        <div className="flex gap-2">
                            <Gamepad2 className={`w-10 h-10 ${isDayMode ? 'text-pink-500' : 'text-pink-400'}`} />
                            <Zap className={`w-10 h-10 ${isDayMode ? 'text-yellow-500' : 'text-yellow-400'}`} />
                        </div>
                        );
                    } else if (plan.iconType === 'gamepad') {
                        plan.icon = <Gamepad2 className={`w-12 h-12 ${isDayMode ? 'text-pink-500' : 'text-pink-400'}`} />;
                    } else {
                        plan.icon = <Zap className={`w-12 h-12 ${isDayMode ? 'text-yellow-500' : 'text-yellow-400'}`} />;
                    }

                    setResult(plan);
                    setStep('result');
                } catch (e) {
                    console.warn("Using offline mock response due to:", e.message);
                    
                    // éš¨æ©Ÿç”¢ç”Ÿé›¢ç·šå›æ‡‰ï¼Œå¢åŠ è¶£å‘³æ€§
                    const mockResponses = [
                        {
                            activity: time === 'long' ? "Switch + è…³è¸è»Š" : "èƒ½é‡è…³è¸è»Š",
                            reason: "ä»Šå¤©é›²å±¤æœ‰é»åšï¼Œé€£ä¸åˆ° AI è¨Šè™Ÿã€‚ä¸éæ²’é—œä¿‚ï¼Œé‹å‹•æ˜¯æœ€å¥½çš„è¨Šè™Ÿå¢å¼·å™¨ï¼å‹•èµ·ä¾†å§ï¼",
                            iconType: time === 'long' ? 'combo' : 'zap'
                        },
                        {
                            activity: "æ·±å‘¼å¸èˆ‡ä¼¸å±•",
                            reason: "ä¼¼ä¹ç¶²è·¯å¡è»Šäº†ã€‚ä¸å¦‚åˆ©ç”¨é€™æ®µæ™‚é–“é–‰ä¸Šçœ¼ï¼Œæ·±å‘¼å¸ï¼Œæ„Ÿå—å¿ƒè·³çš„ç¯€å¥ã€‚",
                            iconType: 'wind'
                        }
                    ];
                    
                    // ç°¡å–®éš¨æ©Ÿé¸æ“‡
                    const mock = mockResponses[Math.floor(Math.random() * mockResponses.length)];

                    if (mock.iconType === 'combo') {
                        mock.icon = (
                        <div className="flex gap-2">
                            <Gamepad2 className={`w-10 h-10 ${isDayMode ? 'text-pink-500' : 'text-pink-400'}`} />
                            <Zap className={`w-10 h-10 ${isDayMode ? 'text-yellow-500' : 'text-yellow-400'}`} />
                        </div>
                        );
                    } else if (mock.iconType === 'wind') {
                        mock.icon = <Wind className="w-12 h-12 text-blue-400" />;
                    } else {
                        mock.icon = <Zap className={`w-12 h-12 ${isDayMode ? 'text-yellow-500' : 'text-yellow-400'}`} />;
                    }

                    setResult(mock);
                    setStep('result');
                }
            };

            const themeColors = isDayMode ? {
                border: 'border-emerald-500',
                accent: 'bg-emerald-100',
                button: 'bg-emerald-500 hover:bg-emerald-600',
                text: 'text-slate-800'
            } : {
                border: 'border-[#5B7C99]',
                accent: 'bg-[#E8F1F5]',
                button: 'bg-[#5B7C99] hover:bg-[#34495E]',
                text: 'text-[#2C3E50]'
            };

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fadeIn">
                <div className={`bg-white/90 rounded-3xl max-w-md w-full p-6 shadow-2xl relative border-4 ${themeColors.border} overflow-hidden`}>
                    <button onClick={onClose} className="absolute top-4 right-4 text-gray-500 hover:text-gray-800 transition-colors">
                    <X size={24} />
                    </button>

                    <div className={`absolute -top-10 -left-10 w-32 h-32 rounded-full blur-xl opacity-50 ${isDayMode ? 'bg-green-200' : 'bg-yellow-200'}`}></div>
                    <div className={`absolute -bottom-10 -right-10 w-32 h-32 rounded-full blur-xl opacity-50 ${isDayMode ? 'bg-blue-200' : 'bg-blue-200'}`}></div>

                    {step === 'input' && (
                    <div className="relative z-10 animate-fadeIn">
                        <div className="flex items-center gap-3 mb-6">
                        <div className={`p-3 rounded-full text-white shadow-lg ${isDayMode ? 'bg-emerald-500' : 'bg-[#5B7C99]'}`}>
                            <Sparkles size={24} />
                        </div>
                        <h3 className={`text-2xl font-bold font-sans ${themeColors.text}`}>AI å¥èº«æ•™ç·´</h3>
                        </div>
                        
                        <p className="text-gray-600 mb-6 font-medium">
                        å˜¿ï¼ä»Šå¤©æ„Ÿè¦ºå¦‚ä½•ï¼Ÿè®“æˆ‘å¹«ä½ è¦åŠƒæœ€é©åˆçš„ç¶ èƒ½é‹å‹•å§ï¼
                        </p>

                        <div className="space-y-4">
                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">ç¾åœ¨çš„å¿ƒæƒ…æ˜¯...</label>
                            <div className="grid grid-cols-3 gap-2">
                            {[
                                { id: 'stress', label: 'å£“åŠ›å¤§', icon: 'ğŸ¤¯' },
                                { id: 'energetic', label: 'å……æ»¿æ´»åŠ›', icon: 'ğŸ’ª' },
                                { id: 'bored', label: 'æœ‰é»ç„¡èŠ', icon: 'ğŸ¥±' }
                            ].map((item) => (
                                <button
                                key={item.id}
                                onClick={() => setMood(item.id)}
                                className={`p-3 rounded-xl border-2 transition-all duration-300 flex flex-col items-center gap-1 ${
                                    mood === item.id 
                                    ? `${themeColors.border} ${themeColors.accent} scale-105 shadow-md` 
                                    : 'border-gray-200 hover:border-gray-300 bg-white'
                                }`}
                                >
                                <span className="text-2xl">{item.icon}</span>
                                <span className="text-xs font-bold text-gray-600">{item.label}</span>
                                </button>
                            ))}
                            </div>
                        </div>

                        <div>
                            <label className="block text-sm font-bold text-gray-700 mb-2">æœ‰å¤šå°‘æ™‚é–“...</label>
                            <div className="grid grid-cols-2 gap-2">
                            {[
                                { id: 'short', label: '< 30 åˆ†é˜' },
                                { id: 'long', label: '> 30 åˆ†é˜' }
                            ].map((item) => (
                                <button
                                key={item.id}
                                onClick={() => setTime(item.id)}
                                className={`p-3 rounded-xl border-2 transition-all duration-300 bg-white ${
                                    time === item.id 
                                    ? `${themeColors.border} ${themeColors.accent} scale-105 shadow-md` 
                                    : 'border-gray-200 hover:border-gray-300'
                                }`}
                                >
                                <span className="text-sm font-bold text-gray-600">{item.label}</span>
                                </button>
                            ))}
                            </div>
                        </div>

                        <button 
                            onClick={generatePlan}
                            disabled={!mood || !time}
                            className={`w-full py-4 rounded-xl font-bold text-lg mt-4 transition-all flex items-center justify-center gap-2 ${
                            !mood || !time 
                                ? 'bg-gray-300 text-gray-500 cursor-not-allowed' 
                                : `${themeColors.button} text-white shadow-lg hover:shadow-xl transform hover:-translate-y-1`
                            }`}
                        >
                            <Sparkles size={20} className="animate-pulse" />
                            é–‹å§‹è¦åŠƒ (Gemini AI)
                        </button>
                        </div>
                    </div>
                    )}

                    {step === 'processing' && (
                    <div className="flex flex-col items-center justify-center py-12 text-center relative z-10 animate-fadeIn">
                        <div className={`w-16 h-16 border-4 border-t-transparent rounded-full animate-spin mb-4 ${isDayMode ? 'border-emerald-500' : 'border-[#5B7C99]'}`}></div>
                        <p className="text-lg text-gray-600 font-medium">Gemini æ­£åœ¨è®€å–æ•¸æ“š...</p>
                        <p className="text-sm text-gray-400 mt-2">å°‹æ‰¾æœ€é©åˆä½ çš„èƒ½é‡é »ç‡</p>
                    </div>
                    )}

                    {step === 'result' && result && (
                    <div className="text-center relative z-10 animate-fadeIn">
                        <div className="flex items-center justify-center mb-4">
                        <div className={`${themeColors.accent} p-6 rounded-full shadow-inner animate-bounce-slow`}>
                            {result.icon}
                        </div>
                        </div>
                        <h3 className={`text-2xl font-bold ${themeColors.text} mb-2`}>æ¨è–¦æ–¹æ¡ˆï¼š</h3>
                        <h4 className={`text-xl ${isDayMode ? 'text-emerald-600' : 'text-[#5B7C99]'} font-black mb-4`}>{result.activity}</h4>
                        
                        <div className={`bg-white/60 rounded-xl p-5 border border-gray-200 shadow-sm mb-6 text-left relative overflow-hidden`}>
                        <div className={`absolute top-0 left-0 w-1 h-full ${isDayMode ? 'bg-emerald-500' : 'bg-[#5B7C99]'}`}></div>
                        <p className="text-gray-700 leading-relaxed font-medium italic">
                            "{result.reason}"
                        </p>
                        </div>

                        <button 
                        onClick={onClose}
                        className={`w-full py-3 text-white rounded-xl font-bold transition-colors shadow-md ${themeColors.button}`}
                        >
                        å¤ªæ£’äº†ï¼æˆ‘çŸ¥é“äº†
                        </button>
                    </div>
                    )}
                </div>
                </div>
            );
        };

        // --- æ˜Ÿæ˜Ÿçš„è€³èª (Poem Generator) å…ƒä»¶ ---
        const StarryWhisper = ({ slideData, onClose, isDayMode }) => {
            const [poem, setPoem] = useState('');
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                const fetchPoem = async () => {
                    try {
                        const prompt = `
                        è«‹é–±è®€ä»¥ä¸‹é—œæ–¼ã€Œ${slideData.title}ã€çš„å…§å®¹ï¼š
                        ${slideData.content.join('ã€‚')}
                        
                        è«‹ç‚ºé€™é ç°¡å ±å¯«ä¸€æ®µã€Œå¹¾ç±³é¢¨æ ¼ã€çš„çŸ­è©©æˆ–æ„Ÿæ€§å°èªï¼ˆç´„ 30-50 å­—ï¼‰ã€‚
                        é¢¨æ ¼è¦æ±‚ï¼šæº«æš–ã€å¤¢å¹»ã€å¸¶é»å“²ç†ï¼Œåƒæ˜¯å°è‘—${isDayMode ? 'è—å¤©ç™½é›²' : 'æ˜Ÿæ˜Ÿ'}èªªè©±ã€‚ä¸è¦å¤ªåš´è‚…çš„æ•¸æ“šåˆ†æï¼Œè¦æ„Ÿæ€§ã€‚
                        ç”¨ç¹é«”ä¸­æ–‡å›ç­”ã€‚
                        `;
                        const text = await callGemini(prompt);
                        
                        if (text) {
                            setPoem(text);
                        } else {
                            // Fallback if API fails
                            setPoem(isDayMode ? "é›²æœµéœéœé£„éï¼Œå®ƒèªªï¼šä¼‘æ¯ä¸€ä¸‹ï¼Œæ˜å¤©æœƒæ›´å¥½ã€‚" : "æ˜Ÿæ˜Ÿçœ¨äº†çœ¨çœ¼ï¼Œå½·å½¿åœ¨èªªï¼šä½ çš„åŠªåŠ›ï¼Œå®‡å®™éƒ½çœ‹è¦‹äº†ã€‚");
                        }
                    } catch (e) {
                        setPoem("è¨Šè™Ÿä¼¼ä¹è¢«é›²é®ä½äº†ï¼Œè«‹ç¨å¾Œå†è©¦...");
                    }
                    setLoading(false);
                };
                fetchPoem();
            }, [slideData, isDayMode]);

            return (
                <div className="absolute inset-0 z-30 flex items-center justify-center p-4 md:p-12 animate-fadeIn bg-black/40 backdrop-blur-sm">
                <div className={`text-white p-8 rounded-3xl max-w-lg w-full relative shadow-[0_0_50px_rgba(255,255,255,0.2)] border border-white/20 ${isDayMode ? 'bg-sky-600/90' : 'bg-[#2C3E50]/90'}`}>
                    <button onClick={onClose} className="absolute top-4 right-4 text-white/50 hover:text-white transition-colors">
                    <X size={24} />
                    </button>
                    
                    <div className="flex flex-col items-center text-center">
                    <div className="mb-6 p-4 bg-white/20 rounded-full">
                        {isDayMode ? (
                        <Wind size={40} className={`text-white ${loading ? 'animate-spin-slow' : 'animate-pulse'}`} />
                        ) : (
                        <Star size={40} className={`text-yellow-300 ${loading ? 'animate-spin-slow' : 'animate-pulse'}`} />
                        )}
                    </div>
                    
                    <h3 className="text-xl font-bold text-white mb-6 font-serif">
                        {isDayMode ? 'âœ¨ é¢¨çš„ä½èª' : 'âœ¨ æ˜Ÿæ˜Ÿçš„è€³èª'}
                    </h3>
                    
                    {loading ? (
                        <div className="space-y-3 w-full opacity-50">
                        <div className="h-4 bg-white/20 rounded animate-pulse w-3/4 mx-auto"></div>
                        <div className="h-4 bg-white/20 rounded animate-pulse w-1/2 mx-auto"></div>
                        <div className="h-4 bg-white/20 rounded animate-pulse w-5/6 mx-auto"></div>
                        </div>
                    ) : (
                        <div className="text-lg md:text-xl leading-loose font-serif italic tracking-wider text-white">
                        {poem}
                        </div>
                    )}
                    </div>
                </div>
                </div>
            );
        }

        // --- ä¸»è¦æ‡‰ç”¨ç¨‹å¼ ---
        function JimmyPresentation() {
            const [currentSlide, setCurrentSlide] = useState(0);
            const [showScript, setShowScript] = useState(false);
            const [showAI, setShowAI] = useState(false);
            const [showWhisper, setShowWhisper] = useState(false);
            const [theme, setTheme] = useState('night'); // 'night' | 'day'
            const touchStartX = useRef(null);

            const isDayMode = theme === 'day';

            const nextSlide = () => {
                if (currentSlide < slidesData.length - 1) {
                setCurrentSlide(prev => prev + 1);
                setShowWhisper(false);
                }
            };

            const prevSlide = () => {
                if (currentSlide > 0) {
                setCurrentSlide(prev => prev - 1);
                setShowWhisper(false);
                }
            };

            useEffect(() => {
                const handleKeyDown = (e) => {
                if (e.key === 'ArrowRight') nextSlide();
                if (e.key === 'ArrowLeft') prevSlide();
                };
                window.addEventListener('keydown', handleKeyDown);
                return () => window.removeEventListener('keydown', handleKeyDown);
            }, [currentSlide]);

            const handleTouchStart = (e) => {
                touchStartX.current = e.touches[0].clientX;
            };

            const handleTouchEnd = (e) => {
                if (!touchStartX.current) return;
                const touchEndX = e.changedTouches[0].clientX;
                const diff = touchStartX.current - touchEndX;

                if (diff > 50) nextSlide();
                if (diff < -50) prevSlide();
                touchStartX.current = null;
            };

            const slide = slidesData[currentSlide];

            // å‹•æ…‹æ¨£å¼
            const styles = isDayMode ? {
                bg: 'bg-[#E8F6F3]', // æ·ºç¶ ç™½
                textPrimary: 'text-slate-800',
                textSecondary: 'text-slate-600',
                accent: 'text-emerald-600',
                cardBg: 'bg-white/40 border-emerald-100',
                videoBorder: 'border-white/50 group-hover/video:border-emerald-400/50',
                footerButton: 'bg-black/5 hover:bg-black/10 text-slate-700',
                activeDot: 'bg-emerald-500',
                inactiveDot: 'bg-slate-300 hover:bg-slate-400',
                gradientText: 'from-emerald-600 to-teal-500',
                bgTexture: 'https://www.transparenttextures.com/patterns/cubes.png' 
            } : {
                bg: 'bg-[#283747]', // æ·±è—ç°
                textPrimary: 'text-white',
                textSecondary: 'text-white/90',
                accent: 'text-yellow-300',
                cardBg: 'bg-black/20 border-white/10',
                videoBorder: 'border-white/20 group-hover/video:border-yellow-400/50',
                footerButton: 'bg-white/10 hover:bg-white/20 text-white',
                activeDot: 'bg-yellow-400',
                inactiveDot: 'bg-white/30 hover:bg-white/50',
                gradientText: 'from-white to-gray-300',
                bgTexture: 'https://www.transparenttextures.com/patterns/watercolor.png'
            };

            const renderBackground = (visual) => {
                switch (visual) {
                case 'cover':
                    return (
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        {isDayMode ? (
                        <>
                            <div className="absolute top-10 right-10 w-48 h-48 bg-yellow-300 rounded-full blur-3xl opacity-60 animate-pulse-slow"></div>
                            <div className="absolute bottom-0 w-full h-1/3 bg-gradient-to-t from-emerald-200 to-transparent opacity-50"></div>
                            <div className="absolute top-20 left-20 w-32 h-16 bg-white/80 rounded-full blur-xl opacity-40 animate-float"></div>
                            <div className="absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-tl from-green-300 to-teal-200 rounded-full blur-3xl opacity-20 animate-blob"></div>
                        </>
                        ) : (
                        <>
                            <div className="absolute top-10 left-10 w-64 h-64 md:w-96 md:h-96 bg-gradient-to-br from-yellow-200 to-yellow-500 rounded-full blur-3xl opacity-30 animate-pulse-slow"></div>
                            <div className="absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-tl from-blue-300 to-purple-500 rounded-full blur-3xl opacity-20 animate-blob"></div>
                        </>
                        )}
                        
                        <div className="absolute bottom-10 w-full h-20 overflow-hidden">
                        <div className="animate-bike-ride absolute bottom-0">
                            <Bike size={64} className={`${isDayMode ? 'text-slate-700' : 'text-white/80'} drop-shadow-lg`} />
                        </div>
                        </div>
                    </div>
                    );
                case 'video_intro':
                    return (
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        <div className={`absolute top-0 right-0 w-full h-full bg-gradient-to-b ${isDayMode ? 'from-transparent via-transparent to-[#E8F6F3]' : 'from-[#283747]/80 via-transparent to-[#283747]'}`}></div>
                    </div>
                    );
                case 'moon':
                    return (
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        {isDayMode ? (
                            <div className="absolute top-10 right-10 w-48 h-48 bg-orange-200 rounded-full blur-2xl opacity-60 animate-pulse-slow"></div>
                        ) : (
                            <>
                            <div className="absolute top-10 right-10 w-48 h-48 md:w-80 md:h-80 bg-yellow-100 rounded-full blur-2xl opacity-80 animate-pulse-slow"></div>
                            <div className="absolute top-16 right-16 w-32 h-32 md:w-64 md:h-64 bg-[#F9E79F] rounded-full shadow-[0_0_60px_rgba(249,231,159,0.6)]"></div>
                            </>
                        )}
                        <div className={`absolute bottom-0 left-0 w-full h-1/3 bg-gradient-to-t ${isDayMode ? 'from-emerald-100' : 'from-[#2C3E50]'} to-transparent opacity-80`}></div>
                    </div>
                    );
                case 'playground':
                    return (
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        <div className={`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-gradient-to-br ${isDayMode ? 'from-sky-200 via-emerald-200 to-yellow-100' : 'from-[#A9CCE3] via-[#D7BDE2] to-[#F9E79F]'} opacity-30 blur-3xl`}></div>
                        <div className="absolute top-20 left-20 w-16 h-16 rounded-full border-4 border-white/30 animate-float"></div>
                        <div className="absolute bottom-20 right-20 w-24 h-24 rounded-full border-8 border-white/20 animate-float-delayed"></div>
                    </div>
                    );
                case 'bulb':
                    return (
                    <div className={`absolute inset-0 overflow-hidden pointer-events-none ${isDayMode ? 'bg-[#F0F9F0]' : 'bg-[#1A252F]'}`}>
                        <div className="absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] opacity-30"></div>
                        <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-yellow-500/20 rounded-full blur-3xl animate-pulse"></div>
                    </div>
                    );
                default:
                    return (
                    <div className="absolute inset-0 overflow-hidden pointer-events-none">
                        <div className={`absolute -bottom-20 -left-20 w-96 h-96 ${isDayMode ? 'bg-green-300' : 'bg-[#76D7C4]'} rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob`}></div>
                        <div className={`absolute top-0 -right-20 w-96 h-96 ${isDayMode ? 'bg-sky-300' : 'bg-[#F1948A]'} rounded-full mix-blend-multiply filter blur-3xl opacity-50 animate-blob animation-delay-2000`}></div>
                    </div>
                    );
                }
            };

            return (
                <div 
                className={`relative w-full h-screen font-sans overflow-hidden select-none flex flex-col transition-colors duration-1000 ${styles.bg} ${styles.textPrimary}`}
                onTouchStart={handleTouchStart}
                onTouchEnd={handleTouchEnd}
                >
                <div 
                    className="absolute inset-0 z-0 opacity-20 pointer-events-none transition-opacity duration-1000" 
                    style={{ backgroundImage: `url('${styles.bgTexture}')` }}
                ></div>
                
                {renderBackground(slide.visual)}

                <div className="relative z-10 flex flex-col flex-1 p-6 md:p-12 max-w-7xl mx-auto w-full h-full overflow-y-auto scrollbar-hide">
                    
                    <header className={`flex justify-between items-start mb-6 md:mb-8 animate-slideDown shrink-0 ${slide.visual === 'cover' ? 'h-full flex-col justify-center items-center text-center' : ''}`}>
                    
                    {slide.visual === 'cover' ? (
                        <div className="flex flex-col items-center justify-center space-y-8 z-20">
                        <span className={`${styles.accent} font-bold tracking-[0.5em] text-xl mb-4 bg-white/10 px-6 py-2 rounded-full backdrop-blur-sm shadow-sm`}>SDGs x USR x Gemini AI</span>
                        <h1 className={`text-5xl md:text-8xl font-black text-transparent bg-clip-text bg-gradient-to-r ${styles.gradientText} drop-shadow-xl`}>
                            {slide.title}
                        </h1>
                        <div className={`w-32 h-2 ${isDayMode ? 'bg-emerald-400' : 'bg-yellow-400'} rounded-full`}></div>
                        <p 
                            className={`${isDayMode ? 'text-slate-600' : 'text-white/90'} font-serif italic text-2xl md:text-3xl leading-relaxed mt-6 drop-shadow-md`}
                            dangerouslySetInnerHTML={{ __html: slide.subtitle }}
                        ></p>
                        </div>
                    ) : (
                        <>
                        <div className="flex flex-col">
                            <span className={`${styles.accent} font-bold tracking-widest text-sm mb-2`}>SDGs x USR x Gemini AI</span>
                            <h1 className={`text-2xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r ${styles.gradientText} drop-shadow-lg mb-2`}>
                            {slide.title}
                            </h1>
                            <p 
                            className={`${styles.textSecondary} font-serif italic text-lg md:text-xl`} 
                            dangerouslySetInnerHTML={{ __html: slide.subtitle }}
                            ></p>
                        </div>
                        <div className="text-right hidden md:block">
                            <span className="text-4xl font-light opacity-50 font-serif italic">{currentSlide + 1}</span>
                            <span className="text-xl opacity-30"> / {slidesData.length}</span>
                        </div>
                        </>
                    )}

                    <button
                        onClick={() => setTheme(prev => prev === 'day' ? 'night' : 'day')}
                        className={`fixed top-6 right-6 z-50 p-3 rounded-full shadow-lg backdrop-blur-md transition-all duration-500 hover:scale-110 group ${isDayMode ? 'bg-orange-100 text-orange-500 hover:bg-orange-200' : 'bg-slate-700 text-yellow-300 hover:bg-slate-600'}`}
                        title={isDayMode ? "åˆ‡æ›è‡³æ˜Ÿç©ºæ¨¡å¼" : "åˆ‡æ›è‡³ç™½å¤©æ¨¡å¼"}
                    >
                        {isDayMode ? (
                        <Sun size={24} className="animate-spin-slow" />
                        ) : (
                        <Moon size={24} className="" />
                        )}
                    </button>
                    </header>

                    {slide.visual !== 'cover' && (
                    <main className="flex-1 flex flex-col md:flex-row gap-6 md:gap-8 relative min-h-0 mt-4 md:mt-8">
                        
                        {/* å·¦å´ï¼šè¦–è¦ºæ„è±¡å€ - æ”¹ç‚º 5/12 */}
                        <div className="w-full md:w-5/12 h-auto md:h-full flex flex-col items-center justify-center relative group shrink-0 gap-4">
                        {slide.visual === 'video_intro' ? (
                            <div className="flex flex-col gap-3 w-full h-full justify-end pb-4 mt-auto">
                            
                            {/* å½±ç‰‡ 3: ç™¼é›»GO */}
                      
<a href="https://https://youtu.be/M_V4vNyDHEU" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className={`w-full h-24 md:h-28 rounded-3xl overflow-hidden shadow-xl border-4 ${styles.videoBorder} relative animate-fadeIn shrink-0 group/video cursor-pointer transition-colors`}
                            >
                                <img 
                                src="https://img.youtube.com/vi/M_V4vNyDHEU/maxresdefault.jpg" 
                                alt="ç™¼é›»GOç¸®åœ–"
                                className="w-full h-full object-cover opacity-90 group-hover/video:opacity-100 transition-opacity transform group-hover/video:scale-105 duration-700"
                                />
                                <div className="absolute inset-0 flex items-center justify-center">
                                <div className="bg-black/30 backdrop-blur-sm p-3 rounded-full group-hover/video:scale-110 transition-transform">
                                    <Play size={20} className="fill-white text-white" />
                                </div>
                                </div>
                                <div className="absolute bottom-2 left-4 pointer-events-none bg-black/60 px-2 py-1 rounded-full backdrop-blur-sm">
                                    <p className="text-yellow-200 font-bold text-xs flex items-center">
                                    <Play size={12} className="inline mr-1 fill-current" />
                                    ç™¼é›»GO
                                    </p>
                                </div>
                            </a>



                            {/* å½±ç‰‡ 1 */}
                            <a 
                                href="https://www.youtube.com/watch?v=4VBeY6e1kfA" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className={`w-full h-24 md:h-28 rounded-3xl overflow-hidden shadow-xl border-4 ${styles.videoBorder} relative animate-fadeIn shrink-0 group/video cursor-pointer transition-colors`}
                            >
                                <img 
                                src="https://img.youtube.com/vi/4VBeY6e1kfA/maxresdefault.jpg" 
                                alt="ç¾å ´å¯¦éŒ„ç¸®åœ–"
                                className="w-full h-full object-cover opacity-90 group-hover/video:opacity-100 transition-opacity transform group-hover/video:scale-105 duration-700"
                                />
                                <div className="absolute inset-0 flex items-center justify-center">
                                <div className="bg-black/30 backdrop-blur-sm p-3 rounded-full group-hover/video:scale-110 transition-transform">
                                    <Play size={20} className="fill-white text-white" />
                                </div>
                                </div>
                                <div className="absolute bottom-2 left-4 pointer-events-none bg-black/60 px-2 py-1 rounded-full backdrop-blur-sm">
                                    <p className="text-yellow-200 font-bold text-xs flex items-center">
                                    <Play size={12} className="inline mr-1 fill-current" />
                                    ç¾å ´å¯¦éŒ„
                                    </p>
                                </div>
                            </a>

                            {/* å½±ç‰‡ 2 */}
                            <a 
                                href="https://www.youtube.com/watch?v=Gf8m9Xh-30g" 
                                target="_blank" 
                                rel="noopener noreferrer"
                                className={`w-full h-24 md:h-28 rounded-3xl overflow-hidden shadow-xl border-4 ${styles.videoBorder} relative animate-fadeIn shrink-0 group/video cursor-pointer transition-colors`}
                            >
                                <img 
                                src="https://img.youtube.com/vi/Gf8m9Xh-30g/maxresdefault.jpg" 
                                alt="NotebookLM ç”Ÿæˆå½±ç‰‡ç¸®åœ–"
                                className="w-full h-full object-cover opacity-90 group-hover/video:opacity-100 transition-opacity transform group-hover/video:scale-105 duration-700"
                                />
                                <div className="absolute inset-0 flex items-center justify-center">
                                    <div className="bg-black/30 backdrop-blur-sm p-3 rounded-full group-hover/video:scale-110 transition-transform">
                                    <Play size={20} className="fill-white text-white" />
                                </div>
                                </div>
                                <div className="absolute bottom-2 left-4 pointer-events-none bg-black/60 px-2 py-1 rounded-full backdrop-blur-sm">
                                    <p className="text-blue-200 font-bold text-xs flex items-center">
                                    <Youtube size={12} className="inline mr-1" />
                                    NotebookLM
                                    </p>
                                </div>
                            </a>

                            
                            </div>
                        ) : (
                            <div className="w-full h-64 md:h-full flex items-center justify-center relative">
                            <div className="absolute inset-0 bg-white/5 rounded-3xl backdrop-blur-sm transform rotate-3 transition-transform group-hover:rotate-6"></div>
                            <div className="absolute inset-0 bg-white/10 rounded-3xl backdrop-blur-md transform -rotate-3 transition-transform group-hover:-rotate-6"></div>
                            
                            <div className="relative z-10 p-8 text-center w-full">
                                {slide.visual === 'moon' && <Wind size={120} className={`${isDayMode ? 'text-blue-300' : 'text-[#F9E79F]'} animate-pulse-slow mx-auto`} />}
                                {slide.visual === 'playground' && (
                                <div className="flex justify-center gap-4">
                                    <Leaf size={80} className={`${isDayMode ? 'text-green-500' : 'text-[#AED6F1]'}`} />
                                    <Gamepad2 size={80} className={`${isDayMode ? 'text-pink-500' : 'text-[#F1948A]'} animate-bounce`} />
                                </div>
                                )}
                                {slide.visual === 'bulb' && <Zap size={120} className={`${isDayMode ? 'text-yellow-500' : 'text-[#F4D03F]'} animate-ping-slow mx-auto`} />}
                                {slide.visual === 'chart' && <div className={`text-6xl font-black ${isDayMode ? 'text-slate-700' : 'text-white/80'}`}>102 <span className="text-2xl">KWH</span></div>}
                                {slide.visual === 'runner' && <Clock size={120} className={`${isDayMode ? 'text-emerald-500' : 'text-[#A2D9CE]'} animate-spin-slow mx-auto`} />}
                                {slide.visual === 'clock' && <div className="text-center"><span className="text-5xl">ğŸŒ</span><hr className={`w-20 my-4 mx-auto ${isDayMode ? 'border-slate-400' : 'border-white/30'}`} /><span className="text-5xl">ğŸŒœ</span></div>}
                                {slide.visual === 'growth' && <Heart size={120} className={`${isDayMode ? 'text-red-400' : 'text-[#F1948A]'} animate-pulse mx-auto`} />}
                                {slide.visual === 'tree' && <div className="text-8xl">ğŸŒ³</div>}
                            </div>
                            </div>
                        )}
                        </div>

                        {/* å³å´ï¼šæ–‡å­—å…§å®¹å€ - æ”¹ç‚º 7/12 */}
                        <div className="w-full md:w-7/12 space-y-6 pb-8">
                        <div className={`backdrop-blur-md p-6 md:p-8 rounded-3xl border shadow-xl animate-fadeIn relative transition-colors duration-500 ${styles.cardBg}`}>
                            <button 
                            onClick={() => setShowWhisper(true)}
                            className={`absolute -top-3 -right-3 p-2 rounded-full shadow-lg hover:scale-110 transition-transform hover:rotate-12 group z-20 ${isDayMode ? 'bg-emerald-500 text-white' : 'bg-yellow-400 text-[#2C3E50]'}`}
                            title="è½è½æ˜Ÿæ˜Ÿ/é¢¨çš„ä½èª (AI ç”Ÿæˆè©©è©)"
                            >
                            <Star size={24} className="fill-current" />
                            <span className="absolute hidden group-hover:block right-full mr-2 top-1/2 -translate-y-1/2 whitespace-nowrap bg-white text-xs px-2 py-1 rounded text-black font-bold">
                                âœ¨ è½è½{isDayMode ? 'é¢¨' : 'æ˜Ÿæ˜Ÿ'}çš„è€³èª (Gemini)
                            </span>
                            </button>

                            <ul className="space-y-4 md:space-y-6">
                            {slide.content.map((point, index) => (
                                <li key={index} className="flex items-start gap-4 group">
                                <span className={`mt-1.5 w-2 h-2 rounded-full group-hover:scale-150 transition-transform shrink-0 ${isDayMode ? 'bg-emerald-500 shadow-emerald-200' : 'bg-yellow-400 shadow-yellow-200'} shadow-[0_0_10px]`}></span>
                                <p className={`text-base md:text-lg leading-relaxed font-medium tracking-wide ${isDayMode ? 'text-slate-700' : 'text-gray-100'}`}>
                                    {point}
                                </p>
                                </li>
                            ))}
                            </ul>
                        </div>

                        <div className="flex gap-4">
                            <button 
                            onClick={() => setShowScript(!showScript)}
                            className={`flex items-center gap-2 text-sm transition-colors px-4 py-2 rounded-full backdrop-blur-sm ${isDayMode ? 'text-slate-600 hover:text-slate-900 bg-white/50 hover:bg-white/80' : 'text-white/50 hover:text-white bg-white/10 hover:bg-white/20'}`}
                            >
                            <BookOpen size={16} />
                            {showScript ? 'éš±è—è¬›ç¨¿' : 'é¡¯ç¤ºè¬›ç¨¿'}
                            </button>
                        </div>
                        
                        {showScript && (
                            <div className={`mt-4 p-4 rounded-xl text-sm leading-loose shadow-lg animate-fadeIn border-2 border-dashed ${isDayMode ? 'bg-white/80 text-slate-700 border-slate-300' : 'bg-[#F9E79F]/90 text-[#2C3E50] border-[#2C3E50]/20'}`}>
                            <span className="font-bold block mb-1">ğŸ“¢ è¬›ç¨¿æç¤ºï¼š</span>
                            {slide.script}
                            </div>
                        )}
                        </div>
                        
                        {showWhisper && <StarryWhisper slideData={slide} onClose={() => setShowWhisper(false)} isDayMode={isDayMode} />}
                    </main>
                    )}

                    <footer className="mt-auto pt-6 flex justify-between items-center relative z-20 shrink-0">
                    <button 
                        onClick={prevSlide} 
                        disabled={currentSlide === 0}
                        className={`p-3 rounded-full transition-all backdrop-blur-sm ${styles.footerButton} ${currentSlide === 0 ? 'opacity-30 cursor-not-allowed' : 'hover:scale-110'}`}
                    >
                        <ChevronLeft size={32} />
                    </button>

                    <div className="flex gap-2">
                        {slidesData.map((_, idx) => (
                        <button 
                            key={idx}
                            onClick={() => setCurrentSlide(idx)}
                            className={`w-3 h-3 rounded-full transition-all duration-500 ${idx === currentSlide ? `${styles.activeDot} w-8` : styles.inactiveDot}`}
                        />
                        ))}
                    </div>

                    <button 
                        onClick={nextSlide} 
                        disabled={currentSlide === slidesData.length - 1}
                        className={`p-3 rounded-full transition-all backdrop-blur-sm ${styles.footerButton} ${currentSlide === slidesData.length - 1 ? 'opacity-30 cursor-not-allowed' : 'hover:scale-110'}`}
                    >
                        <ChevronRight size={32} />
                    </button>
                    </footer>
                </div>

                <button 
                    onClick={() => setShowAI(true)}
                    className="fixed bottom-8 right-8 z-40 group animate-float"
                >
                    <div className="relative">
                    <div className={`absolute inset-0 rounded-full blur-xl opacity-50 group-hover:opacity-80 transition-opacity ${isDayMode ? 'bg-emerald-400' : 'bg-yellow-400'}`}></div>
                    <div className={`relative p-4 rounded-full shadow-2xl border-4 transform group-hover:scale-110 transition-transform ${isDayMode ? 'bg-white text-emerald-600 border-emerald-200' : 'bg-white text-[#2C3E50] border-yellow-200'}`}>
                        <Sparkles size={32} className={isDayMode ? 'text-emerald-500' : 'text-yellow-500'} />
                        <div className="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full animate-bounce">AI</div>
                    </div>
                    </div>
                </button>

                {showAI && <AIAssistant onClose={() => setShowAI(false)} isDayMode={isDayMode} />}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<JimmyPresentation />);
    </script>
</body>
</html>